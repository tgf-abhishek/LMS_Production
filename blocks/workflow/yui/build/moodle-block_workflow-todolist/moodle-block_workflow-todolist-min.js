YUI.add("moodle-block_workflow-todolist",function(e,t){var n="blocks_workflow_todolist",r="/blocks/workflow/ajax.php",i="stateid",s={BLOCKWORKFLOW:"block_workflow",BLOCKTODOLIST:"block_workflow_todolist",BLOCKTODOTASK:"block-workflow-todotask",BLOCKTODOID:"block-workflow-todoid"},o=function(){o.superclass.constructor.apply(this,arguments)};e.extend(o,e.Base,{initializer:function(){e.all("a."+s.BLOCKTODOTASK).each(function(e){e.ancestor("li").on("click",this.toggle,this,e),e.setAttribute("href","#")},this)},toggle:function(t,n){t.halt();var o=new RegExp(s.BLOCKTODOID+"-(\\d{1,})"),u={sesskey:M.cfg.sesskey,action:"toggletaskdone",stateid:this.get(i),todoid:n.getAttribute("id").match(o)[1]};e.io(M.cfg.wwwroot+r,{method:"POST",data:build_querystring(u),on:{complete:function(t,r){var i;try{i=e.JSON.parse(r.responseText);if(i.error)return new M.core.ajaxException(i)}catch(s){new M.core.exception(s)}i.response.iscompleted?n.get("parentNode").addClass("completed"):n.get("parentNode").removeClass("completed")}}})}},{NAME:n,ATTRS:{stateid:{value:null}}}),M.blocks_workflow=M.blocks_workflow||{},M.blocks_workflow.init_todolist=function(e){return new o(e)}},"@VERSION@",{requires:["base","node","event"]});
