{"version":3,"sources":["card_editing_observer.js"],"names":["define","$","Ajax","Templates","Notification","SELECTORS","GENERAL_ROOT","ACTIVITY","COURSE_PROGRESS","PROMISES","GET_COURSE_PROGRESS","courseid","call","methodname","args","init","document","bind","event","container","target","is","data","done","response","render","html","js","replaceNode","fail","exception"],"mappings":"AAAAA,OAAO,CAAC,SAAU,YAAa,iBAAkB,qBAAsB,SAASC,EAAGC,EAAMC,EAAWC,GAMnG,IAAIC,EAAY,CACfC,aAAc,mBACdC,SAAU,cACVC,gBAAiB,6BAOdC,EAAW,CAKdC,oBAAqB,SAASC,GAC7B,OAAOT,EAAKU,KAAK,CAAC,CACLC,WAAY,0CACZC,KAAM,CACFH,SAAUA,MAEd,KAkCZ,MAAO,CACHI,KAVJ,WACId,EAAEe,UAAUC,KAAK,iBAAkB,SAASC,GAnBhD,IACQC,EACAR,EAkBIV,EAAEiB,EAAME,QAAQC,GAAG,iBAnBvBF,EAAYlB,EAAEI,EAAUC,aAAe,IAAMD,EAAUG,iBACvDG,EAAWQ,EAAUG,KAAK,YAC9Bb,EAASC,oBAAoBC,GAC5BY,KAAK,SAASC,GACXA,EAASb,SAAWA,EACpBR,EAAUsB,OAAO,qCAAsCD,GACtDD,KAAK,SAASG,EAAMC,GACjBxB,EAAUyB,YAAYT,EAAWO,EAAMC,KAE1CE,KAAKzB,EAAa0B,aAEtBD,KAAKzB,EAAa0B","sourcesContent":["define(['jquery', 'core/ajax', 'core/templates', 'core/notification'], function($, Ajax, Templates, Notification) {\r\n\r\n    /**\r\n     * element SELECTORS list\r\n     * @type {Object}\r\n     */\r\n\tvar SELECTORS = {\r\n\t\tGENERAL_ROOT: '.general-section',\r\n\t\tACTIVITY: 'li.activity',\r\n\t\tCOURSE_PROGRESS: '.course-prgress-container'\r\n\t};\r\n\r\n    /**\r\n     * Ajax PROMISES\r\n     * @type {Object}\r\n     */\r\n\tvar PROMISES = {\r\n        /**\r\n         * GET_COURSE_PROGRESS promise call\r\n         * @param {Integer} courseid Course id\r\n         */\r\n\t\tGET_COURSE_PROGRESS: function(courseid) {\r\n\t\t\treturn Ajax.call([{\r\n                methodname: 'format_remuiformat_course_progress_data',\r\n                args: {\r\n                    courseid: courseid\r\n                }\r\n            }])[0];\r\n\t\t}\r\n\t};\r\n\r\n    /**\r\n     * Update course progress when activity duplicated or deleted\r\n     */\r\n    function update_course_progress() {\r\n        var container = $(SELECTORS.GENERAL_ROOT + ' ' + SELECTORS.COURSE_PROGRESS);\r\n        var courseid = container.data('courseid');\r\n        PROMISES.GET_COURSE_PROGRESS(courseid)\r\n        .done(function(response) {\r\n            response.courseid = courseid;\r\n            Templates.render('format_remuiformat/course_progress', response)\r\n            .done(function(html, js) {\r\n                Templates.replaceNode(container, html, js);\r\n            })\r\n            .fail(Notification.exception);\r\n        })\r\n        .fail(Notification.exception);\r\n    }\r\n\r\n    /**\r\n     * Initialize js\r\n     */\r\n    function init() {\r\n        $(document).bind('DOMNodeRemoved', function(event) {\r\n            if ($(event.target).is('li.activity')) {\r\n                update_course_progress();\r\n            }\r\n        });\r\n    }\r\n\r\n    // Must return the init function.\r\n    return {\r\n        init: init\r\n    };\r\n});\r\n"],"file":"card_editing_observer.min.js"}